{"version":3,"file":"uploader.min.js","sources":["../src/uploader.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Video assessment\n *\n * @module mod_videoassessment/uploader\n * @package\n * @copyright  2024 Don Hinkleman (hinkelman@mac.com)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['mod_videoassessment/utils'], function (utils) {\n    return {\n\n        /**\n         * Uploads a recorded blob to the Moodle server.\n         * @param {Blob} blob\n         * @param {string} mimeType\n         */\n        upload(blob, mimeType) {\n            const formData = new FormData(document.querySelector('#mform'));\n            const fileName = utils.getFileName(mimeType.split('/')[1]);\n            formData.append('isRecordVideo', 1);\n            formData.append(mimeType.startsWith('audio') ? 'audio' : 'video', blob, fileName);\n\n            const url = document.querySelector('#mform').getAttribute('action');\n            const id = formData.get('id');\n\n            const xhr = new XMLHttpRequest();\n            xhr.open('POST', url);\n            xhr.onload = () => {\n                if (xhr.status === 200) {\n                    window.location.href = `${url}?id=${id}`;\n                }\n            };\n            xhr.send(formData);\n        }\n    };\n});"],"names":["define","utils","upload","blob","mimeType","formData","FormData","document","querySelector","fileName","getFileName","split","append","startsWith","url","getAttribute","id","get","xhr","XMLHttpRequest","open","onload","status","window","location","href","send"],"mappings":";;;;;;;;AAwBAA,sCAAO,CAAC,8BAA8B,SAAUC,aACrC,CAOHC,OAAOC,KAAMC,gBACHC,SAAW,IAAIC,SAASC,SAASC,cAAc,WAC/CC,SAAWR,MAAMS,YAAYN,SAASO,MAAM,KAAK,IACvDN,SAASO,OAAO,gBAAiB,GACjCP,SAASO,OAAOR,SAASS,WAAW,SAAW,QAAU,QAASV,KAAMM,gBAElEK,IAAMP,SAASC,cAAc,UAAUO,aAAa,UACpDC,GAAKX,SAASY,IAAI,MAElBC,IAAM,IAAIC,eAChBD,IAAIE,KAAK,OAAQN,KACjBI,IAAIG,OAAS,KACU,MAAfH,IAAII,SACJC,OAAOC,SAASC,eAAUX,mBAAUE,MAG5CE,IAAIQ,KAAKrB"}