{"version":3,"file":"media.min.js","sources":["../src/media.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Video assessment\n *\n * @module mod_videoassessment/media\n * @package\n * @copyright  2024 Don Hinkleman (hinkelman@mac.com)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([], function () {\n\n    /**\n     * Adds event listeners to detect when the media stream ends.\n     * @param {MediaStream} stream\n     * @param {Function} callback\n     */\n    function addStreamStopListener(stream, callback) {\n        stream.getTracks().forEach(function (track) {\n            ['ended', 'inactive'].forEach(event => {\n                track.addEventListener(event, () => {\n                    callback();\n                    callback = () => { };\n                });\n            });\n        });\n    }\n\n    /**\n     * Captures audio and video from user's media devices.\n     * @param {Function} success\n     * @param {Function} error\n     */\n    function captureUserMedia(success, error) {\n        navigator.mediaDevices.getUserMedia({ audio: true, video: true })\n            .then(function (stream) {\n                success(stream);\n            })\n            .catch(function (err) {\n                error(err);\n            });\n    }\n\n    return {\n        captureUserMedia,\n        addStreamStopListener\n    };\n});"],"names":["define","captureUserMedia","success","error","navigator","mediaDevices","getUserMedia","audio","video","then","stream","catch","err","addStreamStopListener","callback","getTracks","forEach","track","event","addEventListener"],"mappings":";;;;;;;;AAuBAA,mCAAO,IAAI,iBAiCA,CACHC,0BAXsBC,QAASC,OAC/BC,UAAUC,aAAaC,aAAa,CAAEC,OAAO,EAAMC,OAAO,IACrDC,MAAK,SAAUC,QACZR,QAAQQ,WAEXC,OAAM,SAAUC,KACbT,MAAMS,SAMdC,+BA5B2BH,OAAQI,UACnCJ,OAAOK,YAAYC,SAAQ,SAAUC,QAChC,QAAS,YAAYD,SAAQE,QAC1BD,MAAME,iBAAiBD,OAAO,KAC1BJ,WACAA,SAAW"}